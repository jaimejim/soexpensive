<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>It's so expensive - Finnish supermarket price comparison</title>
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="monospace.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 1. Two-column header: Title/Meta on left, Stats on right -->
    <header class="site-header-grid">
        <!-- Dark mode toggle - top right within header -->
        <label class="theme-toggle-header">
            <input type="checkbox" id="themeToggle"> Dark mode
        </label>

        <div class="header-left">
            <h1 class="site-title">It's so expensive</h1>
            <p class="site-subtitle">Compare grocery prices across Finnish supermarkets. Entirely vibecoded.</p>

            <div class="meta-info">
                <div><strong id="metaProducts">--</strong> products tracked</div>
                <div>Last updated: <strong id="metaLastUpdate">--</strong></div>
            </div>
        </div>

        <div class="header-right">
            <div class="insight-item">
                <span class="insight-label">Cheapest overall</span>
                <strong class="insight-value" id="cheapestOverall">--</strong>
            </div>
            <div class="insight-item">
                <span class="insight-label">Cheapest for most items</span>
                <strong class="insight-value" id="cheapestCount">--</strong>
            </div>
            <div class="insight-item">
                <span class="insight-label">Avg price gap (worst vs best)</span>
                <strong class="insight-value" id="priceGap">--</strong>
            </div>
        </div>
    </header>

    <!-- 3. Store Comparison Chart -->
    <section class="chart-section" data-title="Store Comparison">
        <h2>Store Comparison</h2>

        <div class="chart-grid">
            <figure class="chart-figure">
                <pre id="asciiChart" class="hidden"></pre>
                <div id="chartSkeleton" class="hidden"><span class="spinner"></span></div>
                <figcaption>
                    █ Cheapest | ░ Available
                </figcaption>
            </figure>

            <div class="chart-table">
                <table id="storeTable">
                    <thead>
                        <tr>
                            <th>Store</th>
                            <th>Cheapest Count</th>
                            <th>Avg Price</th>
                            <th>Rank</th>
                        </tr>
                    </thead>
                    <tbody id="storeComparisonBody">
                        <tr id="storeSkeleton">
                            <td colspan="4"><span class="spinner"></span> Loading...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- 4. Products Table -->
    <section class="products-section" data-title="Products">
        <h2>Products</h2>

        <!-- Filters grouped -->
        <div class="filter-block">
            <label class="filter-label">Filter products</label>
            <div class="filter-grid">
                <input type="text" id="searchInput" placeholder="Search products...">
            </div>
        </div>

        <div id="loading" class="loading-state hidden">
            <span class="spinner"></span>
            <span class="loading-text"> Loading price comparison</span>
        </div>

        <div class="table-container">
            <table id="productsTable" class="products-table">
                <thead>
                    <tr>
                        <th class="sticky-col sortable" data-sort="name">Product</th>
                        <th class="sortable" data-sort="category">Category</th>
                        <th class="sortable" data-sort="unit">Unit</th>
                        <th class="sortable" data-sort="S-Market">S-Market</th>
                        <th class="sortable" data-sort="Prisma">Prisma</th>
                        <th class="sortable" data-sort="K-Citymarket">K-City</th>
                        <th class="sortable" data-sort="K-Supermarket">K-Super</th>
                        <th class="sortable" data-sort="Lidl">Lidl</th>
                        <th class="sortable" data-sort="Alepa">Alepa</th>
                        <th class="sortable" data-sort="best">Best</th>
                    </tr>
                </thead>
                <tbody id="productsTableBody">
                    <tr class="skeleton-row">
                        <td colspan="10"><span class="spinner"></span> Loading products...</td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                    </tr>
                    <tr class="skeleton-row">
                        <td><div class="skeleton skeleton-text medium"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                    </tr>
                    <tr class="skeleton-row">
                        <td><div class="skeleton skeleton-text"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                        <td><div class="skeleton skeleton-text short"></div></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Data freshness legend -->
        <div class="data-legend">
            <strong>Data sources:</strong>
            <span class="legend-item"><sup>✓</sup> Verified prices (K-Citymarket, S-Market, Prisma)</span>
            <span class="legend-item">Other stores: estimated based on verified data</span>
        </div>
    </section>

    <script src="app.js"></script>
    <script>
        window.si = window.si || function () { (window.siq = window.siq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/speed-insights/script.js"></script>
</body>
</html>
